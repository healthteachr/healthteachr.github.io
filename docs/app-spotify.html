<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta name="generator" content="quarto-1.2.269">
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">
<title>Applied Data Skills - Appendix J — Spotify Data</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1.6em;
  vertical-align: middle;
}
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<link href="./app-webpage.html" rel="next">
<link href="./app-styling.html" rel="prev">
<link href="./images/logos/favicon.ico" rel="icon">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" class="quarto-color-scheme" id="quarto-text-highlighting-styles">
<link href="site_libs/quarto-html/quarto-syntax-highlighting-dark.css" rel="prefetch" class="quarto-color-scheme quarto-color-alternate" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" class="quarto-color-scheme" id="quarto-bootstrap" data-mode="light">
<link href="site_libs/bootstrap/bootstrap-dark.min.css" rel="prefetch" class="quarto-color-scheme quarto-color-alternate" id="quarto-bootstrap" data-mode="dark"><script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 20,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit"
  }
}</script><script async="" src="https://www.googletagmanager.com/gtag/js?id=G-6NP3MF25W3"></script><script type="text/javascript">

window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'G-6NP3MF25W3', { 'anonymize_ip': true});
</script><script src="site_libs/htmlwidgets-1.5.4/htmlwidgets.js"></script><link href="site_libs/datatables-css-0.0.0/datatables-crosstalk.css" rel="stylesheet">
<script src="site_libs/datatables-binding-0.26/datatables.js"></script><script src="site_libs/jquery-3.6.0/jquery-3.6.0.min.js"></script><link href="site_libs/dt-core-1.12.1/css/jquery.dataTables.min.css" rel="stylesheet">
<link href="site_libs/dt-core-1.12.1/css/jquery.dataTables.extra.css" rel="stylesheet">
<script src="site_libs/dt-core-1.12.1/js/jquery.dataTables.min.js"></script><link href="site_libs/crosstalk-1.2.0/css/crosstalk.min.css" rel="stylesheet">
<script src="site_libs/crosstalk-1.2.0/js/crosstalk.min.js"></script><link href="site_libs/pagedtable-1.1/css/pagedtable.css" rel="stylesheet">
<script src="site_libs/pagedtable-1.1/js/pagedtable.js"></script><link rel="stylesheet" href="include/psyteachr.css">
<link rel="stylesheet" href="include/webex.css">
<link rel="stylesheet" href="include/style.css">
</head>
<body class="nav-sidebar floating">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top"><nav class="quarto-secondary-nav" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }"><div class="container-fluid d-flex justify-content-between">
      <h1 class="quarto-secondary-nav-title">Appendix J — Spotify Data</h1>
      <button type="button" class="quarto-btn-toggle btn" aria-label="Show secondary navigation">
        <i class="bi bi-chevron-right"></i>
      </button>
    </div>
  </nav></header><!-- content --><div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse sidebar-navigation floating overflow-auto"><div class="pt-lg-2 mt-2 text-left sidebar-header">
    <div class="sidebar-title mb-0 py-0">
      <a href="./">Applied Data Skills</a> 
        <div class="sidebar-tools-main tools-wide">
    <a href="https://github.com/psyteachr/ads-v2/" title="Source Code" class="sidebar-tool px-1"><i class="bi bi-github"></i></a>
    <a href="" title="Share" id="sidebar-tool-dropdown-0" class="sidebar-tool dropdown-toggle px-1" data-bs-toggle="dropdown" aria-expanded="false"><i class="bi bi-share"></i></a>
    <ul class="dropdown-menu" aria-labelledby="sidebar-tool-dropdown-0">
<li>
          <a class="dropdown-item sidebar-tools-main-item" href="https://twitter.com/intent/tweet?url=%7Curl%7C">
            <i class="bi bi-bi-twitter pe-1"></i>
          Twitter
          </a>
        </li>
        <li>
          <a class="dropdown-item sidebar-tools-main-item" href="https://www.facebook.com/sharer/sharer.php?u=%7Curl%7C">
            <i class="bi bi-bi-facebook pe-1"></i>
          Facebook
          </a>
        </li>
        <li>
          <a class="dropdown-item sidebar-tools-main-item" href="https://www.linkedin.com/sharing/share-offsite/?url=%7Curl%7C">
            <i class="bi bi-bi-linkedin pe-1"></i>
          LinkedIn
          </a>
        </li>
    </ul>
<a href="" class="quarto-color-scheme-toggle sidebar-tool" onclick="window.quartoToggleColorScheme(); return false;" title="Toggle dark mode"><i class="bi"></i></a>
</div>
    </div>
      </div>
      <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
      </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./index.html" class="sidebar-item-text sidebar-link">Overview</a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./01-intro.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">Intro to R and RStudio</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./02-reports.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Reports with R Markdown</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./03-viz.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Data Visualisation</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./04-data.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Data Import</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./05-summary.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">Data Summaries</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./06-formative.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">Practice Report</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./07-joins.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">7</span>&nbsp; <span class="chapter-title">Data Relations</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./08-tidy.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">8</span>&nbsp; <span class="chapter-title">Data Tidying</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./09-wrangle.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">9</span>&nbsp; <span class="chapter-title">Data Wrangling</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./10-custom.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">10</span>&nbsp; <span class="chapter-title">Customising Visualisations &amp; Reports</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./11-refs.html" class="sidebar-item-text sidebar-link">References</a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./12-license.html" class="sidebar-item-text sidebar-link">License/Citation</a>
  </div>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" aria-expanded="true">Appendices</a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" aria-expanded="true">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 show">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./app-installing-r.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">A</span>&nbsp; <span class="chapter-title">Installing R</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./app-updating-r.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">B</span>&nbsp; <span class="chapter-title">Updating R, RStudio, and packages</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./app-symbols.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">C</span>&nbsp; <span class="chapter-title">Symbols</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./app-conventions.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">D</span>&nbsp; <span class="chapter-title">Conventions</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./app-teams.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">E</span>&nbsp; <span class="chapter-title">Using Teams</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./app-debugging.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">F</span>&nbsp; <span class="chapter-title">Debugging</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./app-datatypes.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">G</span>&nbsp; <span class="chapter-title">Data Types</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./app-dates.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">H</span>&nbsp; <span class="chapter-title">Dates and Times</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./app-styling.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">I</span>&nbsp; <span class="chapter-title">Styling Plots</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./app-spotify.html" class="sidebar-item-text sidebar-link active"><span class="chapter-number">J</span>&nbsp; <span class="chapter-title">Spotify Data</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./app-webpage.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">K</span>&nbsp; <span class="chapter-title">Webpages</span></a>
  </div>
</li>
      </ul>
</li>
    </ul>
</div>
</nav><!-- margin-sidebar --><div id="quarto-margin-sidebar" class="sidebar margin-sidebar"><div class="quarto-margin-header"><div class="margin-header-item">
<p><a href="https://doi.org/10.5281/zenodo.6365077"><img src="https://zenodo.org/badge/DOI/10.5281/zenodo.6365077.svg" alt="DOI"></a></p>
</div></div>
        <nav id="TOC" role="doc-toc" class="toc-active"><h2 id="toc-title">Table of contents</h2>
   
  <ul>
<li>
<a href="#by-artist" id="toc-by-artist" class="nav-link active" data-scroll-target="#by-artist"><span class="toc-section-number">J.1</span>  By Artist</a>
  <ul class="collapse">
<li><a href="#tracks-per-album" id="toc-tracks-per-album" class="nav-link" data-scroll-target="#tracks-per-album"><span class="toc-section-number">J.1.1</span>  Tracks per Album</a></li>
  <li><a href="#tempo" id="toc-tempo" class="nav-link" data-scroll-target="#tempo"><span class="toc-section-number">J.1.2</span>  Tempo</a></li>
  </ul>
</li>
  <li>
<a href="#by-playlist" id="toc-by-playlist" class="nav-link" data-scroll-target="#by-playlist"><span class="toc-section-number">J.2</span>  By Playlist</a>
  <ul class="collapse">
<li><a href="#track-ratings" id="toc-track-ratings" class="nav-link" data-scroll-target="#track-ratings"><span class="toc-section-number">J.2.1</span>  Track ratings</a></li>
  <li><a href="#popularity" id="toc-popularity" class="nav-link" data-scroll-target="#popularity"><span class="toc-section-number">J.2.2</span>  Popularity</a></li>
  <li><a href="#nested-data" id="toc-nested-data" class="nav-link" data-scroll-target="#nested-data"><span class="toc-section-number">J.2.3</span>  Nested data</a></li>
  </ul>
</li>
  <li>
<a href="#by-genre" id="toc-by-genre" class="nav-link" data-scroll-target="#by-genre"><span class="toc-section-number">J.3</span>  By Genre</a>
  <ul class="collapse">
<li><a href="#repeated-calls" id="toc-repeated-calls" class="nav-link" data-scroll-target="#repeated-calls"><span class="toc-section-number">J.3.1</span>  Repeated calls</a></li>
  </ul>
</li>
  <li>
<a href="#by-track" id="toc-by-track" class="nav-link" data-scroll-target="#by-track"><span class="toc-section-number">J.4</span>  By Track</a>
  <ul class="collapse">
<li><a href="#features" id="toc-features" class="nav-link" data-scroll-target="#features"><span class="toc-section-number">J.4.1</span>  Features</a></li>
  <li><a href="#analysis" id="toc-analysis" class="nav-link" data-scroll-target="#analysis"><span class="toc-section-number">J.4.2</span>  Analysis</a></li>
  </ul>
</li>
  </ul><div class="toc-actions"><div><i class="bi bi-github"></i></div><div class="action-links"><p><a href="https://github.com/psyteachr/ads-v2/edit/master/app-spotify.qmd" class="toc-action">Edit this page</a></p><p><a href="https://github.com/psyteachr/ads-v2/issues/new" class="toc-action">Report an issue</a></p><p><a href="https://github.com/psyteachr/ads-v2/blob/master/app-spotify.qmd" class="toc-action">View source</a></p></div></div></nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content"><header id="title-block-header" class="quarto-title-block default"><div class="quarto-title">
<h1 class="title"><span id="sec-spotify" class="quarto-section-identifier d-none d-lg-block">Appendix J — Spotify Data</span></h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  

</header><p>This appendix was inspired by <a href="https://mcmullarkey.github.io/mcm-blog/posts/2022-01-07-spotify-api-r/" target="_blank">Michael Mullarkey’s tutorial</a>, which you can follow to make beautiful dot plots out of your own Spotify data. This tutorial doesn’t require you to use Spotify; just to create a developer account so you can access their data API with <pkg>spotifyr”, “https://www.rcharlie.com/spotifyr/”)`.</pkg></p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1"></a><span class="fu">library</span>(usethis)    <span class="co"># to set system environment variables</span></span>
<span id="cb1-2"><a href="#cb1-2"></a><span class="fu">library</span>(spotifyr)   <span class="co"># to access Spotify</span></span>
<span id="cb1-3"><a href="#cb1-3"></a><span class="fu">library</span>(tidyverse)  <span class="co"># for data wrangling</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>── Attaching packages ─────────────────────────────────────── tidyverse 1.3.2 ──
✔ tibble  3.1.8     ✔ forcats 0.5.2
✔ stringr 1.4.1     
── Conflicts ────────────────────────────────────────── tidyverse_conflicts() ──
✖ faux::%||%()             masks purrr::%||%()
✖ dplyr::filter()          masks stats::filter()
✖ kableExtra::group_rows() masks dplyr::group_rows()
✖ rvest::guess_encoding()  masks readr::guess_encoding()
✖ dplyr::lag()             masks stats::lag()</code></pre>
</div>
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1"></a><span class="fu">library</span>(DT)         <span class="co"># for interactive tables</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>The package <a href="https://www.rcharlie.com/spotifyr" target="_blank">spotifyr</a> has instructions for setting up a developer account with Spotify and setting up an “app” so you can get authorisation codes.</p>
<p>Once you’ve set up the app, you can copy the client ID and secret to your R environment file. The easiest way to do this is with <code>edit_r_environ()</code> from <pkg>usethis</pkg>. Setting scope to “user” makes this available to any R project on your computer, while setting it to “project” makes it only available to this project.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1"></a>usethis<span class="sc">::</span><span class="fu">edit_r_environ</span>(<span class="at">scope =</span> <span class="st">"user"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Add the following text to your environment file (don’t delete anything already there), replacing the zeros with your personal ID and secret. Save and close the file and restart R.</p>
<pre><code>SPOTIFY_CLIENT_ID="0000000000000000000000000000"
SPOTIFY_CLIENT_SECRET="0000000000000000000000000000"</code></pre>
<p>Double check that it worked by typing the following into the console. Don’t put it in your script unless you mean to share this confidential info. You should see your values, not ““, if it worked.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1"></a><span class="co"># run in the console, don't save in a script</span></span>
<span id="cb6-2"><a href="#cb6-2"></a><span class="fu">Sys.getenv</span>(<span class="st">"SPOTIFY_CLIENT_ID"</span>)</span>
<span id="cb6-3"><a href="#cb6-3"></a><span class="fu">Sys.getenv</span>(<span class="st">"SPOTIFY_CLIENT_SECRET"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Now you’re ready to get data from Spotify. There are several types of data that you can download.</p>
<section id="by-artist" class="level2" data-number="J.1"><h2 data-number="J.1" class="anchored" data-anchor-id="by-artist">
<span class="header-section-number">J.1</span> By Artist</h2>
<p>Choose your favourite artist and download their discography. Set <code>include_groups</code> to one or more of “album”, “single”, “appears_on”, and “compilation”.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1"></a>gaga <span class="ot">&lt;-</span> <span class="fu">get_artist_audio_features</span>(</span>
<span id="cb7-2"><a href="#cb7-2"></a>  <span class="at">artist =</span> <span class="st">'Lady Gaga'</span>,</span>
<span id="cb7-3"><a href="#cb7-3"></a>  <span class="at">include_groups =</span> <span class="st">"album"</span></span>
<span id="cb7-4"><a href="#cb7-4"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Let’s explore the data you get back. Use <code>glimpse()</code> to see what columns are available and what type of data they have. It looks like there is a row for each of this artist’s tracks.</p>
<p>Let’s answer a few simple questions first.</p>
<section id="tracks-per-album" class="level3" data-number="J.1.1"><h3 data-number="J.1.1" class="anchored" data-anchor-id="tracks-per-album">
<span class="header-section-number">J.1.1</span> Tracks per Album</h3>
<p>How many tracks are on each album? Some tracks have more than one entry in the table, so first select just the <code>album_name</code> and <code>track_name</code> columns and use <code>distinct()</code> to get rid of duplicates. Then <code>count()</code> the tracks per album. We’re using <code><a href="https://rdrr.io/pkg/DT/man/datatable.html">DT::datatable()</a></code> to make the table interactive. Try sorting the table by number of tracks.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1"></a>gaga <span class="sc">%&gt;%</span></span>
<span id="cb8-2"><a href="#cb8-2"></a>  <span class="fu">select</span>(album_name, track_name) <span class="sc">%&gt;%</span></span>
<span id="cb8-3"><a href="#cb8-3"></a>  <span class="fu">distinct</span>() <span class="sc">%&gt;%</span></span>
<span id="cb8-4"><a href="#cb8-4"></a>  <span class="fu">count</span>(album_name) <span class="sc">%&gt;%</span></span>
<span id="cb8-5"><a href="#cb8-5"></a>  <span class="fu">datatable</span>(<span class="at">colnames =</span> <span class="fu">c</span>(<span class="st">"Albumn Name"</span>, <span class="st">"Number of Tracks"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">

<div id="htmlwidget-c87c707887b858de53c0" style="width:100%;height:auto;" class="datatables html-widget"></div>
<script type="application/json" data-for="htmlwidget-c87c707887b858de53c0">{"x":{"filter":"none","vertical":false,"data":[["1","2","3","4","5","6","7","8","9","10","11","12","13","14","15","16","17","18","19","20","21","22","23","24","25"],["A Star Is Born Soundtrack","A Star Is Born Soundtrack (Without Dialogue)","ARTPOP","Born This Way","Born This Way - The Remix","Born This Way (International Special Edition Version)","Born This Way (International Standard Version)","Born This Way (Japan Special Edition Version)","Born This Way (Japan Standard Version)","Born This Way (Special Edition)","BORN THIS WAY THE TENTH ANNIVERSARY","Cheek To Cheek","Cheek To Cheek (Deluxe)","Chromatica","Dawn Of Chromatica","Joanne","Joanne (Deluxe)","Love For Sale (Deluxe)","The Fame","The Fame Monster","The Fame Monster (Deluxe Edition)","The Fame Monster (France FNAC Version)","The Fame Monster (France Virgin Version)","The Fame Monster (International Deluxe)","The Fame Monster (UK Deluxe)"],[36,19,17,14,16,23,15,24,16,22,15,11,17,16,14,14,14,12,15,8,23,25,25,24,24]],"container":"<table class=\"display\">\n  <thead>\n    <tr>\n      <th> <\/th>\n      <th>Albumn Name<\/th>\n      <th>Number of Tracks<\/th>\n    <\/tr>\n  <\/thead>\n<\/table>","options":{"columnDefs":[{"className":"dt-right","targets":2},{"orderable":false,"targets":0}],"order":[],"autoWidth":false,"orderClasses":false}},"evals":[],"jsHooks":[]}</script>
</div>
</div>
<div class="callout-note try callout callout-style-default callout-captioned">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-caption-container flex-fill">
Note
</div>
</div>
<div class="callout-body-container callout-body">
<p>Use <code>count()</code> to explore the columns <code>key_name</code>, <code>mode_name</code>, and any other non-numeric columns.</p>
</div>
</div>
</section><section id="tempo" class="level3" data-number="J.1.2"><h3 data-number="J.1.2" class="anchored" data-anchor-id="tempo">
<span class="header-section-number">J.1.2</span> Tempo</h3>
<p>What sort of tempo is Lady Gaga’s music? First, let’s look at a very basic plot to get an overview.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1"></a><span class="fu">ggplot</span>(gaga, <span class="fu">aes</span>(tempo)) <span class="sc">+</span></span>
<span id="cb9-2"><a href="#cb9-2"></a>  <span class="fu">geom_histogram</span>(<span class="at">binwidth =</span> <span class="dv">1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure"><p><img src="app-spotify_files/figure-html/unnamed-chunk-6-1.png" class="img-fluid figure-img" style="width:100.0%"></p>
</figure>
</div>
</div>
</div>
<p>What’s going on with the tracks with a tempo of 0?</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1"></a>gaga <span class="sc">%&gt;%</span> </span>
<span id="cb10-2"><a href="#cb10-2"></a>  <span class="fu">filter</span>(tempo <span class="sc">==</span> <span class="dv">0</span>) <span class="sc">%&gt;%</span></span>
<span id="cb10-3"><a href="#cb10-3"></a>  <span class="fu">select</span>(album_name, track_name)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">

<div data-pagedtable="false">
  <script data-pagedtable-source="" type="application/json">
{"columns":[{"label":["album_name"],"name":[1],"type":["chr"],"align":["left"]},{"label":["track_name"],"name":[2],"type":["chr"],"align":["left"]}],"data":[{"1":"A Star Is Born Soundtrack","2":"First Stop, Arizona - Dialogue"},{"1":"A Star Is Born Soundtrack","2":"How Do You Hear It? - Dialogue"},{"1":"A Star Is Born Soundtrack","2":"SNL - Dialogue"},{"1":"A Star Is Born Soundtrack","2":"First Stop, Arizona - Dialogue"},{"1":"A Star Is Born Soundtrack","2":"How Do You Hear It? - Dialogue"},{"1":"A Star Is Born Soundtrack","2":"SNL - Dialogue"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
</div>
<p>Looks like it’s all dialogue, so we should omit these. Let’s also check how variable the tempo is for multiple instances of the same track. A quick way to do this is to group by album and track, then check the <a class="glossary" target="_blank" title="A descriptive statistic that measures how spread out data are relative to the mean." href="https://psyteachr.github.io/glossary/s#standard-deviation">standard deviation</a> of the tempo. If it’s 0, this means that all of the values are identical. The bigger it is, the more the values vary. If you have a lot of data with a <a class="glossary" target="_blank" title="A symmetric distribution of data where values near the centre are most probable." href="https://psyteachr.github.io/glossary/n#normal-distribution">normal distribution</a> (like a bell curve), then about 68% of the data are within one SD of the mean, and about 95% are within 2 SDs.</p>
<p>If we filter to tracks with SD greater than 0 (so any variation at all), we see that most tracks have a little variation. However, if we filter to tracks with an SD greater than 1, we see a few songs with slightly different tempo, and a few with wildly different tempo.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1"></a>gaga <span class="sc">%&gt;%</span></span>
<span id="cb11-2"><a href="#cb11-2"></a>  <span class="co"># omit tracks with "Dialogue" in the name</span></span>
<span id="cb11-3"><a href="#cb11-3"></a>  <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">str_detect</span>(track_name, <span class="st">"Dialogue"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb11-4"><a href="#cb11-4"></a>  <span class="co"># check for varying tempos for same track</span></span>
<span id="cb11-5"><a href="#cb11-5"></a>  <span class="fu">group_by</span>(album_name, track_name) <span class="sc">%&gt;%</span></span>
<span id="cb11-6"><a href="#cb11-6"></a>  <span class="fu">filter</span>(<span class="fu">sd</span>(tempo) <span class="sc">&gt;</span> <span class="dv">1</span>) <span class="sc">%&gt;%</span></span>
<span id="cb11-7"><a href="#cb11-7"></a>  <span class="fu">ungroup</span>() <span class="sc">%&gt;%</span></span>
<span id="cb11-8"><a href="#cb11-8"></a>  <span class="fu">select</span>(album_name, track_name, tempo) <span class="sc">%&gt;%</span></span>
<span id="cb11-9"><a href="#cb11-9"></a>  <span class="fu">arrange</span>(album_name, track_name)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">

<div data-pagedtable="false">
  <script data-pagedtable-source="" type="application/json">
{"columns":[{"label":["album_name"],"name":[1],"type":["chr"],"align":["left"]},{"label":["track_name"],"name":[2],"type":["chr"],"align":["left"]},{"label":["tempo"],"name":[3],"type":["dbl"],"align":["right"]}],"data":[{"1":"BORN THIS WAY THE TENTH ANNIVERSARY","2":"The Edge Of Glory","3":"127.957"},{"1":"BORN THIS WAY THE TENTH ANNIVERSARY","2":"The Edge Of Glory","3":"124.004"},{"1":"BORN THIS WAY THE TENTH ANNIVERSARY","2":"Yoü And I","3":"127.073"},{"1":"BORN THIS WAY THE TENTH ANNIVERSARY","2":"Yoü And I","3":"124.428"},{"1":"Cheek To Cheek","2":"Sophisticated Lady","3":"75.221"},{"1":"Cheek To Cheek","2":"Sophisticated Lady","3":"138.475"},{"1":"Joanne","2":"Come To Mama","3":"179.911"},{"1":"Joanne","2":"Come To Mama","3":"179.911"},{"1":"Joanne","2":"Come To Mama","3":"119.962"},{"1":"Joanne (Deluxe)","2":"Come To Mama","3":"179.911"},{"1":"Joanne (Deluxe)","2":"Come To Mama","3":"119.962"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
</div>
<p>You can deal with these in any way you choose. Filter out some versions of the songs or listen to them to see which value you agree with and change the others. Here, we’ll deal with it by averaging the values for each track. This will also remove the tiny differences in the majority of duplicate tracks. Now we’re ready to plot.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1"></a>gaga <span class="sc">%&gt;%</span></span>
<span id="cb12-2"><a href="#cb12-2"></a>  <span class="fu">filter</span>(tempo <span class="sc">&gt;</span> <span class="dv">0</span>) <span class="sc">%&gt;%</span></span>
<span id="cb12-3"><a href="#cb12-3"></a>  <span class="fu">group_by</span>(album_name, track_name) <span class="sc">%&gt;%</span></span>
<span id="cb12-4"><a href="#cb12-4"></a>  <span class="fu">summarise</span>(<span class="at">tempo =</span> <span class="fu">round</span>(<span class="fu">mean</span>(tempo)),</span>
<span id="cb12-5"><a href="#cb12-5"></a>            <span class="at">.groups =</span> <span class="st">"drop"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb12-6"><a href="#cb12-6"></a>  <span class="fu">ungroup</span>() <span class="sc">%&gt;%</span></span>
<span id="cb12-7"><a href="#cb12-7"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> tempo, <span class="at">fill =</span> ..x..)) <span class="sc">+</span></span>
<span id="cb12-8"><a href="#cb12-8"></a>  <span class="fu">geom_histogram</span>(<span class="at">binwidth =</span> <span class="dv">4</span>, <span class="at">show.legend =</span> <span class="cn">FALSE</span>) <span class="sc">+</span></span>
<span id="cb12-9"><a href="#cb12-9"></a>  <span class="fu">scale_fill_gradient</span>(<span class="at">low =</span> <span class="st">"#521F64"</span>, <span class="at">high =</span> <span class="st">"#E8889C"</span>) <span class="sc">+</span></span>
<span id="cb12-10"><a href="#cb12-10"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Beats per minute"</span>,</span>
<span id="cb12-11"><a href="#cb12-11"></a>       <span class="at">y =</span> <span class="st">"Number of tracks"</span>,</span>
<span id="cb12-12"><a href="#cb12-12"></a>       <span class="at">title =</span> <span class="st">"Tempo of Lady Gaga Tracks"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure"><p><img src="app-spotify_files/figure-html/unnamed-chunk-9-1.png" class="img-fluid figure-img" style="width:100.0%"></p>
</figure>
</div>
</div>
</div>
<div class="callout-note try callout callout-style-default callout-captioned">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-caption-container flex-fill">
Note
</div>
</div>
<div class="callout-body-container callout-body">
<p>Can you see how we made the gradient fill for the histograms? Since the x-value of each bar depends on the binwidth, you have to use the code <code>..x..</code> in the mapping (not <code>tempo</code>) to make the fill correspond to each bar’s value.</p>
</div>
</div>
<p>This looks OK, but maybe we want a more striking plot. Let’s make a custom plot style and assign it to <code>gaga_style</code> in case we want to use it again. Then add it to the shortcut function, <code>last_plot()</code> to avoid having to retype the code for the last plot we created.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1"></a><span class="co"># define style</span></span>
<span id="cb13-2"><a href="#cb13-2"></a>gaga_style <span class="ot">&lt;-</span> <span class="fu">theme</span>(</span>
<span id="cb13-3"><a href="#cb13-3"></a>  <span class="at">plot.background =</span> <span class="fu">element_rect</span>(<span class="at">fill =</span> <span class="st">"black"</span>),</span>
<span id="cb13-4"><a href="#cb13-4"></a>  <span class="at">text =</span> <span class="fu">element_text</span>(<span class="at">color =</span> <span class="st">"white"</span>, <span class="at">size =</span> <span class="dv">11</span>),</span>
<span id="cb13-5"><a href="#cb13-5"></a>  <span class="at">panel.background =</span> <span class="fu">element_rect</span>(<span class="at">fill =</span> <span class="st">"black"</span>),</span>
<span id="cb13-6"><a href="#cb13-6"></a>  <span class="at">panel.grid.major.x =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb13-7"><a href="#cb13-7"></a>  <span class="at">panel.grid.minor.x =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb13-8"><a href="#cb13-8"></a>  <span class="at">panel.grid.major.y =</span> <span class="fu">element_line</span>(<span class="at">colour =</span> <span class="st">"white"</span>, <span class="at">size =</span> <span class="fl">0.2</span>),</span>
<span id="cb13-9"><a href="#cb13-9"></a>  <span class="at">panel.grid.minor.y =</span> <span class="fu">element_line</span>(<span class="at">colour =</span> <span class="st">"white"</span>, <span class="at">size =</span> <span class="fl">0.2</span>),</span>
<span id="cb13-10"><a href="#cb13-10"></a>  <span class="at">axis.text =</span> <span class="fu">element_text</span>(<span class="at">color =</span> <span class="st">"white"</span>),</span>
<span id="cb13-11"><a href="#cb13-11"></a>  <span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">hjust =</span> <span class="fl">0.5</span>)</span>
<span id="cb13-12"><a href="#cb13-12"></a>)</span>
<span id="cb13-13"><a href="#cb13-13"></a></span>
<span id="cb13-14"><a href="#cb13-14"></a><span class="do">## add it to the last plot created</span></span>
<span id="cb13-15"><a href="#cb13-15"></a><span class="fu">last_plot</span>() <span class="sc">+</span> gaga_style</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure"><p><img src="app-spotify_files/figure-html/unnamed-chunk-10-1.png" class="img-fluid figure-img" style="width:100.0%"></p>
</figure>
</div>
</div>
</div>
</section></section><section id="by-playlist" class="level2" data-number="J.2"><h2 data-number="J.2" class="anchored" data-anchor-id="by-playlist">
<span class="header-section-number">J.2</span> By Playlist</h2>
<p>You need to know the “uri” of a public playlist to access data on it. You can get this by copying the link to the playlist and selecting the 22 characters between “https://open.spotify.com/playlist/” and “?si=…”. Let’s have a look at the Eurovision 2021 playlist.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1"></a>eurovision2021 <span class="ot">&lt;-</span> <span class="fu">get_playlist_audio_features</span>(</span>
<span id="cb14-2"><a href="#cb14-2"></a>  <span class="at">playlist_uris =</span> <span class="st">"37i9dQZF1DWVCKO3xAlT1Q"</span></span>
<span id="cb14-3"><a href="#cb14-3"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Use <code>glimpse()</code> and <code>count()</code> to explore the structure of this table.</p>
<section id="track-ratings" class="level3" data-number="J.2.1"><h3 data-number="J.2.1" class="anchored" data-anchor-id="track-ratings">
<span class="header-section-number">J.2.1</span> Track ratings</h3>
<p>Each track has several ratings: danceability, energy, speechiness, acousticness, instrumentalness, liveness, and valence. I’m not sure how these are determined (almost certainly by an algorithm). Let’s select the track names and these columns to have a look.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1"></a>eurovision2021 <span class="sc">%&gt;%</span></span>
<span id="cb15-2"><a href="#cb15-2"></a>  <span class="fu">select</span>(track.name, danceability, energy, speechiness<span class="sc">:</span>valence) <span class="sc">%&gt;%</span></span>
<span id="cb15-3"><a href="#cb15-3"></a>  <span class="fu">datatable</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">

<div id="htmlwidget-09612b4de114f64d5891" style="width:100%;height:auto;" class="datatables html-widget"></div>
<script type="application/json" data-for="htmlwidget-09612b4de114f64d5891">{"x":{"filter":"none","vertical":false,"data":[["1","2","3","4","5","6","7","8","9","10","11","12","13","14","15","16","17","18","19","20","21","22","23","24","25","26","27","28","29","30","31","32","33","34","35","36","37","38","39"],["ZITTI E BUONI","Je me casse - Eurovision Official Entry","El Diablo","Voilà","Discoteque","Voices","10 Years","Adrenalina","Set Me Free","Tout l'univers","Last Dance","Embers","Mata Hari","SHUM","RUSSIAN WOMAN","Sugar","Loco Loco","growing up is getting old - Eurovision Version","The Wrong Place","Voy a quedarme","Fallen Angel","Dark Side","Karma","Birth Of A New Age","I Don't Feel Hate","Love Is On My Side","Tick-Tock","Technicolour","Maps","Amnesia","The lucky one","Omaga","The Ride","Øve Os På Hinanden","The Moon Is Rising - Original","Amen","Amen","You","Here I Stand"],[0.62,0.767,0.66,0.447,0.826,0.503,0.798,0.665,0.752,0.534,0.533,0.678,0.706,0.527,0.89,0.694,0.655,0.413,0.491,0.517,0.542,0.571,0.515,0.718,0.827,0.285,0.765,0.665,0.543,0.582,0.403,0.717,0.69,0.678,0.656,0.448,0.442,0.497,0.322],[0.944,0.871,0.664,0.337,0.799,0.759,0.621,0.886,0.664,0.365,0.91,0.819,0.675,0.737,0.701,0.76,0.747,0.193,0.728,0.72,0.647,0.955,0.627,0.718,0.837,0.419,0.758,0.567,0.833,0.693,0.639,0.872,0.771,0.867,0.628,0.397,0.384,0.367,0.195],[0.0863,0.1,0.134,0.0631,0.0594,0.0423,0.0391,0.082,0.0775,0.033,0.0435,0.0577,0.0386,0.0642,0.194,0.0464,0.0841,0.0296,0.0428,0.0488,0.0277,0.105,0.0448,0.0609,0.214,0.0286,0.0352,0.0338,0.0416,0.135,0.0739,0.033,0.0262,0.0268,0.144,0.0478,0.0397,0.0245,0.0365],[0.0014,0.153,0.00395,0.773,0.0477,0.00237,0.0141,0.00319,0.28,0.81,0.0213,0.00283,0.0128,0.05,0.204,0.00495,0.294,0.796,0.0479,0.214,0.071,0.00254,0.00371,0.479,0.19,0.338,0.0503,0.0656,0.0212,0.125,0.0386,0.109,0.403,0.0128,0.0387,0.476,0.0102,0.238,0.512],[0,1.27e-06,0,0,0.00206,1.06e-06,0.000148,1.22e-06,0,2.52e-06,0,2.67e-06,0.000355,7.85e-05,0,0.00566,0,1.09e-06,1.38e-06,0,0,1.55e-06,0,8.8e-06,9.72e-06,3.26e-06,0.00068,0,0,1.38e-06,0,0.00156,0,3.19e-05,0,0.000272,6.51e-05,0.0432,0],[0.733,0.277,0.832,0.298,0.125,0.13,0.0926,0.387,0.102,0.158,0.0699,0.112,0.263,0.105,0.0741,0.134,0.243,0.095,0.16,0.0839,0.108,0.274,0.127,0.234,0.0346,0.197,0.343,0.269,0.36,0.158,0.0918,0.344,0.25,0.344,0.142,0.149,0.0831,0.189,0.318],[0.592,0.79,0.621,0.603,0.628,0.396,0.443,0.529,0.468,0.237,0.393,0.722,0.463,0.499,0.652,0.511,0.594,0.312,0.246,0.355,0.281,0.437,0.192,0.539,0.752,0.244,0.76,0.274,0.547,0.245,0.409,0.886,0.926,0.961,0.331,0.206,0.0843,0.12,0.133]],"container":"<table class=\"display\">\n  <thead>\n    <tr>\n      <th> <\/th>\n      <th>track.name<\/th>\n      <th>danceability<\/th>\n      <th>energy<\/th>\n      <th>speechiness<\/th>\n      <th>acousticness<\/th>\n      <th>instrumentalness<\/th>\n      <th>liveness<\/th>\n      <th>valence<\/th>\n    <\/tr>\n  <\/thead>\n<\/table>","options":{"columnDefs":[{"className":"dt-right","targets":[2,3,4,5,6,7,8]},{"orderable":false,"targets":0}],"order":[],"autoWidth":false,"orderClasses":false}},"evals":[],"jsHooks":[]}</script>
</div>
</div>
<p>What was the general mood of Eurovision songs in 2021? Let’s use plots to assess. First, we need to get the data into long format to make it easier to plot multiple attributes.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1"></a>playlist_attributes <span class="ot">&lt;-</span> eurovision2021 <span class="sc">%&gt;%</span></span>
<span id="cb16-2"><a href="#cb16-2"></a>  <span class="fu">select</span>(track.name, danceability, energy, speechiness<span class="sc">:</span>valence) <span class="sc">%&gt;%</span></span>
<span id="cb16-3"><a href="#cb16-3"></a>  <span class="fu">pivot_longer</span>(<span class="at">cols =</span> danceability<span class="sc">:</span>valence,</span>
<span id="cb16-4"><a href="#cb16-4"></a>               <span class="at">names_to =</span> <span class="st">"attribute"</span>,</span>
<span id="cb16-5"><a href="#cb16-5"></a>               <span class="at">values_to =</span> <span class="st">"rating"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>When we plot everything on the same plot, instrumentalness has such a consistently low value that all the other attributes disappear,</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1"></a><span class="fu">ggplot</span>(playlist_attributes, <span class="fu">aes</span>(<span class="at">x =</span> rating, <span class="at">colour =</span> attribute)) <span class="sc">+</span></span>
<span id="cb17-2"><a href="#cb17-2"></a>  <span class="fu">geom_density</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure"><p><img src="app-spotify_files/figure-html/unnamed-chunk-14-1.png" class="img-fluid figure-img" style="width:100.0%"></p>
</figure>
</div>
</div>
</div>
<p>You can solve this by putting each attribute into its own facet and letting the y-axis differ between plots by setting <code>scales = "free_y"</code>. Now it’s easier to see that Eurovision songs tend to have pretty high danceability and energy.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1"></a><span class="fu">ggplot</span>(playlist_attributes, <span class="fu">aes</span>(<span class="at">x =</span> rating, <span class="at">colour =</span> attribute)) <span class="sc">+</span></span>
<span id="cb18-2"><a href="#cb18-2"></a>  <span class="fu">geom_density</span>(<span class="at">show.legend =</span> <span class="cn">FALSE</span>) <span class="sc">+</span></span>
<span id="cb18-3"><a href="#cb18-3"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span>attribute, <span class="at">scales =</span> <span class="st">"free_y"</span>, <span class="at">nrow =</span> <span class="dv">2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure"><p><img src="app-spotify_files/figure-html/playlist-attributes-facet-1.png" class="img-fluid figure-img" style="width:100.0%"></p>
<p></p><figcaption class="figure-caption">Seven track attributes for the playlist ‘Eurovision 2021’</figcaption><p></p>
</figure>
</div>
</div>
</div>
</section><section id="popularity" class="level3" data-number="J.2.2"><h3 data-number="J.2.2" class="anchored" data-anchor-id="popularity">
<span class="header-section-number">J.2.2</span> Popularity</h3>
<p>Let’s look at how these attributes relate to track popularity. We’ll exclude instrumentalness, since it doesn’t have much variation.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1"></a>popularity <span class="ot">&lt;-</span> eurovision2021 <span class="sc">%&gt;%</span></span>
<span id="cb19-2"><a href="#cb19-2"></a>  <span class="fu">select</span>(track.name, track.popularity,</span>
<span id="cb19-3"><a href="#cb19-3"></a>         acousticness, danceability, energy, </span>
<span id="cb19-4"><a href="#cb19-4"></a>         liveness, speechiness, valence) <span class="sc">%&gt;%</span></span>
<span id="cb19-5"><a href="#cb19-5"></a>  <span class="fu">pivot_longer</span>(<span class="at">cols =</span> acousticness<span class="sc">:</span>valence,</span>
<span id="cb19-6"><a href="#cb19-6"></a>               <span class="at">names_to =</span> <span class="st">"attribute"</span>,</span>
<span id="cb19-7"><a href="#cb19-7"></a>               <span class="at">values_to =</span> <span class="st">"rating"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1"></a><span class="fu">ggplot</span>(popularity, <span class="fu">aes</span>(<span class="at">x =</span> rating, <span class="at">y =</span> track.popularity, <span class="at">colour =</span> attribute)) <span class="sc">+</span></span>
<span id="cb20-2"><a href="#cb20-2"></a>  <span class="fu">geom_point</span>(<span class="at">alpha =</span> <span class="fl">0.5</span>, <span class="at">show.legend =</span> <span class="cn">FALSE</span>) <span class="sc">+</span></span>
<span id="cb20-3"><a href="#cb20-3"></a>  <span class="fu">geom_smooth</span>(<span class="at">method =</span> lm, <span class="at">formula =</span> y<span class="sc">~</span>x, <span class="at">show.legend =</span> <span class="cn">FALSE</span>) <span class="sc">+</span></span>
<span id="cb20-4"><a href="#cb20-4"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span>attribute, <span class="at">scales =</span> <span class="st">"free_x"</span>, <span class="at">nrow =</span> <span class="dv">2</span>) <span class="sc">+</span></span>
<span id="cb20-5"><a href="#cb20-5"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Attribute Value"</span>,</span>
<span id="cb20-6"><a href="#cb20-6"></a>       <span class="at">y =</span> <span class="st">"Track Popularity"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure"><p><img src="app-spotify_files/figure-html/playlist-popularity-1.png" class="img-fluid figure-img" style="width:100.0%"></p>
<p></p><figcaption class="figure-caption">The relationship between track attributes and popularity.</figcaption><p></p>
</figure>
</div>
</div>
</div>
</section><section id="nested-data" class="level3" data-number="J.2.3"><h3 data-number="J.2.3" class="anchored" data-anchor-id="nested-data">
<span class="header-section-number">J.2.3</span> Nested data</h3>
<p>Some of the columns in this table contain more tables. For example, each entry in the <code>track.artist</code> column contains a table with columns <code>href</code>, <code>id</code>, <code>name</code>, <code>type</code>, <code>uri</code>, and <code>external_urls.spotify</code>. Use <code>unnest()</code> to extract these tables. If there is more than one artist for a track, this will expand the table. For example, the track “Adrenalina” has two rows now, one for Senhit and one for Flo Rida.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1"></a>eurovision2021 <span class="sc">%&gt;%</span></span>
<span id="cb21-2"><a href="#cb21-2"></a>  <span class="fu">unnest</span>(track.artists) <span class="sc">%&gt;%</span></span>
<span id="cb21-3"><a href="#cb21-3"></a>  <span class="fu">select</span>(<span class="at">track =</span> track.name, </span>
<span id="cb21-4"><a href="#cb21-4"></a>         <span class="at">artist =</span> name, </span>
<span id="cb21-5"><a href="#cb21-5"></a>         <span class="at">popularity =</span> track.popularity) <span class="sc">%&gt;%</span></span>
<span id="cb21-6"><a href="#cb21-6"></a>  <span class="fu">datatable</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">

<div id="htmlwidget-3c554e0acb37103d1bdf" style="width:100%;height:auto;" class="datatables html-widget"></div>
<script type="application/json" data-for="htmlwidget-3c554e0acb37103d1bdf">{"x":{"filter":"none","vertical":false,"data":[["1","2","3","4","5","6","7","8","9","10","11","12","13","14","15","16","17","18","19","20","21","22","23","24","25","26","27","28","29","30","31","32","33","34","35","36","37","38","39","40"],["ZITTI E BUONI","Je me casse - Eurovision Official Entry","El Diablo","Voilà","Discoteque","Voices","10 Years","Adrenalina","Adrenalina","Set Me Free","Tout l'univers","Last Dance","Embers","Mata Hari","SHUM","RUSSIAN WOMAN","Sugar","Loco Loco","growing up is getting old - Eurovision Version","The Wrong Place","Voy a quedarme","Fallen Angel","Dark Side","Karma","Birth Of A New Age","I Don't Feel Hate","Love Is On My Side","Tick-Tock","Technicolour","Maps","Amnesia","The lucky one","Omaga","The Ride","Øve Os På Hinanden","The Moon Is Rising - Original","Amen","Amen","You","Here I Stand"],["Måneskin","Destiny","Elena Tsagrinou","Barbara Pravi","THE ROOP","Tusse","Daði Freyr","Senhit","Flo Rida","Eden Alene","Gjon's Tears","Stefania","James Newman","Efendi","Go_A","Manizha","Natalia Gordienko","Hurricane","VICTORIA","Hooverphonic","Blas Cantó","TIX","Blind Channel","Anxhela Peristeri","Jeangu Macrooy","Jendrik","The Black Mamba","Albina","Montaigne","Lesley Roy","Roxen","Uku Suviste","Benny Cristo","Rafał Brzozowski","Fyr Og Flamme","Samanta Tina","Ana Soklič","Vincent Bueno","Tornike Kipiani","Vasil Garvanliev"],[70,23,42,68,59,63,65,54,54,56,63,56,54,60,22,58,51,0,48,54,54,61,9,45,48,2,50,49,50,48,53,44,45,43,51,44,40,40,38,37]],"container":"<table class=\"display\">\n  <thead>\n    <tr>\n      <th> <\/th>\n      <th>track<\/th>\n      <th>artist<\/th>\n      <th>popularity<\/th>\n    <\/tr>\n  <\/thead>\n<\/table>","options":{"columnDefs":[{"className":"dt-right","targets":3},{"orderable":false,"targets":0}],"order":[],"autoWidth":false,"orderClasses":false}},"evals":[],"jsHooks":[]}</script>
</div>
</div>
<div class="callout-note try callout callout-style-default callout-captioned">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-caption-container flex-fill">
Note
</div>
</div>
<div class="callout-body-container callout-body">
<p>If you’re a Eurovision nerd (like Emily), try downloading playlists from several previous years and visualise trends. See if you can find lists of the <a href="https://en.wikipedia.org/wiki/Eurovision_Song_Contest_2021" target="_blank">scores for each year</a> and join the data to see what attributes are most related to points.</p>
</div>
</div>
</section></section><section id="by-genre" class="level2" data-number="J.3"><h2 data-number="J.3" class="anchored" data-anchor-id="by-genre">
<span class="header-section-number">J.3</span> By Genre</h2>
<p>Select the first 20 artists in the genre “eurovision”. So that people don’t spam the Spotify API, you are limited to up to 50 artists per request.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1"></a>euro_genre <span class="ot">&lt;-</span> <span class="fu">get_genre_artists</span>(</span>
<span id="cb22-2"><a href="#cb22-2"></a>  <span class="at">genre =</span> <span class="st">"eurovision"</span>,</span>
<span id="cb22-3"><a href="#cb22-3"></a>  <span class="at">limit =</span> <span class="dv">20</span>,</span>
<span id="cb22-4"><a href="#cb22-4"></a>  <span class="at">offset =</span> <span class="dv">0</span></span>
<span id="cb22-5"><a href="#cb22-5"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1"></a>euro_genre <span class="sc">%&gt;%</span></span>
<span id="cb23-2"><a href="#cb23-2"></a>  <span class="fu">select</span>(name, popularity, followers.total) <span class="sc">%&gt;%</span></span>
<span id="cb23-3"><a href="#cb23-3"></a>  <span class="fu">datatable</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">

<div id="htmlwidget-3d7b59375ea8fd689c30" style="width:100%;height:auto;" class="datatables html-widget"></div>
<script type="application/json" data-for="htmlwidget-3d7b59375ea8fd689c30">{"x":{"filter":"none","vertical":false,"data":[["1","2","3","4","5","6","7","8","9","10","11","12","13","14","15","16","17","18","19","20"],["Alexander Rybak","Go_A","Netta","Blind Channel","Lena","Getter Jaani","Natalia Lacunza","Amir","Roxen","Carla","Paul Rey","Polina Gagarina","Barbara Pravi","Dima Bilan","Loïc Nottet","KEiiNO","Gjon's Tears","Amaia","Loreen","TIX"],[65,58,56,61,64,48,63,65,55,50,54,56,59,58,55,54,52,60,56,64],[212934,129801,114062,142931,669688,11656,179226,597922,42421,50024,30159,647298,96600,339235,199642,44231,35912,259295,799438,198288]],"container":"<table class=\"display\">\n  <thead>\n    <tr>\n      <th> <\/th>\n      <th>name<\/th>\n      <th>popularity<\/th>\n      <th>followers.total<\/th>\n    <\/tr>\n  <\/thead>\n<\/table>","options":{"columnDefs":[{"className":"dt-right","targets":[2,3]},{"orderable":false,"targets":0}],"order":[],"autoWidth":false,"orderClasses":false}},"evals":[],"jsHooks":[]}</script>
</div>
</div>
<p>Now you can select the next 20 artists, incrementing the offset by 20, join that to the first table, and process the data.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1"></a>euro_genre2 <span class="ot">&lt;-</span> <span class="fu">get_genre_artists</span>(</span>
<span id="cb24-2"><a href="#cb24-2"></a>  <span class="at">genre =</span> <span class="st">"eurovision"</span>,</span>
<span id="cb24-3"><a href="#cb24-3"></a>  <span class="at">limit =</span> <span class="dv">20</span>,</span>
<span id="cb24-4"><a href="#cb24-4"></a>  <span class="at">offset =</span> <span class="dv">20</span></span>
<span id="cb24-5"><a href="#cb24-5"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb25"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1"></a><span class="fu">bind_rows</span>(euro_genre, euro_genre2) <span class="sc">%&gt;%</span></span>
<span id="cb25-2"><a href="#cb25-2"></a>  <span class="fu">select</span>(name, popularity, followers.total) <span class="sc">%&gt;%</span></span>
<span id="cb25-3"><a href="#cb25-3"></a>  <span class="fu">datatable</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">

<div id="htmlwidget-4ffa5f81262942a5097b" style="width:100%;height:auto;" class="datatables html-widget"></div>
<script type="application/json" data-for="htmlwidget-4ffa5f81262942a5097b">{"x":{"filter":"none","vertical":false,"data":[["1","2","3","4","5","6","7","8","9","10","11","12","13","14","15","16","17","18","19","20","21","22","23","24","25","26","27","28","29","30","31","32","33","34","35","36","37","38","39","40"],["Alexander Rybak","Go_A","Netta","Blind Channel","Lena","Getter Jaani","Natalia Lacunza","Amir","Roxen","Carla","Paul Rey","Polina Gagarina","Barbara Pravi","Dima Bilan","Loïc Nottet","KEiiNO","Gjon's Tears","Amaia","Loreen","TIX","Patrik Jean","Helena Paparizou","Sergey Lazarev","Måns Zelmerlöw","Blas Cantó","Jorn","Sevak","Sunstroke Project","Mikolas Josef","Brinck","Dotter","Mustasch","Senhit","Maléna","Kristian Kostov","Eden Alene","Timebelle","Dami Im","Jüri Pootsmann","Ryan O'Shaughnessy"],[65,58,56,61,64,48,63,65,55,50,54,56,59,58,55,54,52,60,56,64,46,52,55,56,56,46,49,42,52,35,50,50,43,49,43,44,41,45,41,38],[212934,129801,114062,142931,669688,11656,179226,597922,42421,50024,30159,647298,96600,339235,199642,44231,35912,259295,799438,198288,5339,98363,120274,152020,228398,70914,18700,21914,67383,2191,34594,110601,5412,4631,36119,13224,5059,52070,8802,30213]],"container":"<table class=\"display\">\n  <thead>\n    <tr>\n      <th> <\/th>\n      <th>name<\/th>\n      <th>popularity<\/th>\n      <th>followers.total<\/th>\n    <\/tr>\n  <\/thead>\n<\/table>","options":{"columnDefs":[{"className":"dt-right","targets":[2,3]},{"orderable":false,"targets":0}],"order":[],"autoWidth":false,"orderClasses":false}},"evals":[],"jsHooks":[]}</script>
</div>
</div>
<section id="repeated-calls" class="level3" data-number="J.3.1"><h3 data-number="J.3.1" class="anchored" data-anchor-id="repeated-calls">
<span class="header-section-number">J.3.1</span> Repeated calls</h3>
<p>There is a programmatic way to make several calls to a function that limits you. You usually want to set this up so that you are waiting a few seconds or minutes between calls so that you don’t get locked out (depending on how strict the API is). Use <code>map_df()</code> to automatically join the results into one big table.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb26"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb26-1"><a href="#cb26-1"></a><span class="co"># create a slow version of get_genre_artists </span></span>
<span id="cb26-2"><a href="#cb26-2"></a><span class="co"># delays 2 seconds after running</span></span>
<span id="cb26-3"><a href="#cb26-3"></a>slow_get_genre_artists <span class="ot">&lt;-</span> <span class="fu">slowly</span>(get_genre_artists, </span>
<span id="cb26-4"><a href="#cb26-4"></a>                                 <span class="at">rate =</span> <span class="fu">rate_delay</span>(<span class="dv">2</span>))</span>
<span id="cb26-5"><a href="#cb26-5"></a></span>
<span id="cb26-6"><a href="#cb26-6"></a><span class="co"># set 4 offsets from 0 to 150 by 50</span></span>
<span id="cb26-7"><a href="#cb26-7"></a>offsets <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="dv">0</span>, <span class="dv">150</span>, <span class="dv">50</span>)</span>
<span id="cb26-8"><a href="#cb26-8"></a></span>
<span id="cb26-9"><a href="#cb26-9"></a><span class="co"># run the slow function once for each offset</span></span>
<span id="cb26-10"><a href="#cb26-10"></a>euro_genre200 <span class="ot">&lt;-</span> <span class="fu">map_df</span>(<span class="at">.x =</span> offsets, </span>
<span id="cb26-11"><a href="#cb26-11"></a>                       <span class="at">.f =</span> <span class="sc">~</span><span class="fu">slow_get_genre_artists</span>(<span class="st">"eurovision"</span>, </span>
<span id="cb26-12"><a href="#cb26-12"></a>                                                    <span class="at">limit =</span> <span class="dv">50</span>,</span>
<span id="cb26-13"><a href="#cb26-13"></a>                                                    <span class="at">offset =</span> .x))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb27"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb27-1"><a href="#cb27-1"></a>euro_genre200 <span class="sc">%&gt;%</span></span>
<span id="cb27-2"><a href="#cb27-2"></a>  <span class="fu">select</span>(name, popularity, followers.total) <span class="sc">%&gt;%</span></span>
<span id="cb27-3"><a href="#cb27-3"></a>  <span class="fu">arrange</span>(<span class="fu">desc</span>(followers.total)) <span class="sc">%&gt;%</span></span>
<span id="cb27-4"><a href="#cb27-4"></a>  <span class="fu">datatable</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">

<div id="htmlwidget-0ca3b1ed1f70ec61604d" style="width:100%;height:auto;" class="datatables html-widget"></div>
<script type="application/json" data-for="htmlwidget-0ca3b1ed1f70ec61604d">{"x":{"filter":"none","vertical":false,"data":[["1","2","3","4","5","6","7","8","9","10","11","12","13","14","15","16","17","18","19","20","21","22","23","24","25","26","27","28","29","30","31","32","33","34","35","36","37","38","39","40","41","42","43","44","45","46","47","48","49","50","51","52","53","54","55","56","57","58","59","60","61","62","63","64","65","66","67","68","69","70","71","72","73","74","75","76","77","78","79","80","81","82","83","84","85","86","87","88","89","90","91","92","93","94","95","96","97","98","99","100","101","102","103","104","105","106","107","108","109","110","111","112","113","114","115","116","117","118","119","120","121","122","123","124","125","126","127","128","129","130","131","132","133","134","135","136","137","138","139","140","141","142","143","144","145","146","147","148","149","150","151","152","153","154","155","156","157","158","159","160","161","162","163","164","165","166","167","168","169","170","171","172","173","174","175","176","177","178","179","180","181","182","183","184","185","186","187","188","189","190","191","192","193","194","195","196","197","198","199","200"],["Loreen","Lena","Polina Gagarina","Amir","Can Bonomo","Dima Bilan","Amaia","Blas Cantó","Alexander Rybak","Loïc Nottet","TIX","Eric Saade","Natalia Lacunza","Viki Gabor","Måns Zelmerlöw","Blind Channel","Go_A","Sergey Lazarev","Netta","Miki Núñez","Mustasch","Helena Paparizou","Barbara Pravi","Shiri Maimon","Bilal Hassani","Ivi Adamou","Chiara Galiazzo","Harel Skaat","Jorn","Mikolas Josef","Teflon Brothers","Voltaj","Jamala","Lillasyster","Dami Im","Nadav Guedj","Carla","Conchita Wurst","KEiiNO","Michal Szpak","Julia Medina","Roxen","Laura Tesoro","Madame Monsieur","Tony Cetinski","Emil Assergård","Valentina","Kristian Kostov","Gjon's Tears","Ruth Lorenzo","Dotter","Jedward","Željko Joksimović","Ryan O'Shaughnessy","María Escarmiento","Paul Rey","ZOË","THE ROOP","Ace Wilder","Daneliya Tuleshova","Saara Aalto","Emmelie de Forest","Robin Bengtsson","Sofi Marinova","Stavangerkameratene","Mandinga","Nina Badric","Demy","Anna Bergendahl","MÉLOVIN","Marija Šerifović","Sunstroke Project","Blanche","Charlotte Perrelli","Famous Oberogo","Jessica Andersson","Donny Montell","Ruslana","VICTORIA","Sevak","Zlata Ognevich","Marilia Monzón","Ilta","Gabriella","Manel Navarro","Mariette","Eden Alene","zalagasper","Tooji","Lake Malawi","Efendi","Eleftheria Eleftheriou","Berkes Olivér","Getter Jaani","Alma","Philippine","Ulrikke","Kalomira","Sirusho","Elena Tsagrinou","Fyr Og Flamme","Rasmussen","Gaitana","AYDAN","Klara Hammarström","Jüri Pootsmann","Nathan Trent","LMK","Elina Born","Brendan Murray","Sara James","Poli Genova","Aminata","Florina","Dana International","Raylee","Rambo Amadeus","Cesar Sampson","Stina Talling","Iveta Mukuchyan","Gabrielius Vagelis","Ira Losco","Kadiatou","Ieva Zasimauskaitė","Senhit","Patrik Jean","Boggie","KOIT TOOME","Timebelle","Kaliopi","Ryan Dolan","Naestro","Jakub Ondra","Maléna","Elina Nechayeva","Yianna Terzi","Sona","Albina","Kasia Moś","Dihaj","Samanta Tina","Alvaro Estrella","Joan Franka","Equinox","Safura","Inga &amp; Anush","Uku Suviste","Seemone","Greta Salóme","Izabo","Mørland","Natalia Gordienko","Franka","Bella Paige","Filip Rudan","Marta Jandová","Nina Sublatti","Betty Missiego","Jordan Anthony","François Deguelt","Ilinca","Brinck","Elhaida Dani","Andrei Zevakin","Nina Kraljic","Athena Manoukian","Ole Hartz","DoReDoS","Tijana Bogicevic","Serhat","Roberto Bellarosa","Rykka","Christina","Frida Green","Ana Soklič","Enzo","Aksel","21 Juin Le Duo","Bacchelli","Karl Killing","River","Gebrasy","Pasha Parfeni","Mekado","Dajte Muzika","Jasmin Rose","Таня Меженцева","Niko Kajaia","Tara Mobee","Elsie Bay","Vincenzo Cantiello","Wiiralt","Elina Konstantopoulou","Olena Usenko","Chanel","Subwoolfer","Elisabetta Lizza","Dora","Blanca Paloma Ramos Baeza","Marianna"],[55,64,55,65,65,58,60,56,66,55,64,50,62,51,56,61,58,55,56,54,49,52,59,42,45,47,43,45,46,51,55,39,43,48,44,38,50,42,54,36,43,55,41,47,41,53,43,42,51,34,50,31,39,38,40,53,38,47,33,32,37,40,46,36,48,38,42,40,49,40,40,42,41,45,32,42,37,39,42,49,31,34,48,36,39,36,44,35,22,33,46,33,42,48,35,47,46,31,32,51,44,35,27,32,44,41,32,41,36,23,49,32,30,32,34,38,23,39,44,31,34,29,46,28,43,46,23,34,41,22,30,41,33,50,29,36,32,36,35,24,34,41,18,27,24,24,33,31,24,19,31,37,29,22,28,43,21,31,26,26,25,35,23,30,22,28,47,23,27,32,31,26,47,42,26,39,26,20,22,30,35,26,27,19,32,29,32,30,23,38,20,17,18,26,37,35,28,22,34,14],[799600,667930,634791,594177,525257,332404,258103,227377,210594,198856,196734,182088,178681,157739,151858,141921,128750,117692,113384,112022,110443,97117,95644,93593,89503,82642,72770,72071,70671,67344,60941,60741,56445,54108,51900,49649,49287,46770,44415,42915,42246,41682,40334,38989,37957,37683,36385,35998,35457,35132,34347,33881,32643,31516,31353,30137,29120,28790,28775,28592,28408,27948,27881,27714,26958,26691,26093,25718,24300,22567,21925,21880,21727,21571,19451,19128,18503,18469,18187,17256,17130,16612,15239,14018,13840,13752,13086,12985,12970,12945,12745,12641,12236,11626,11601,11418,11239,10723,10217,10168,10138,9387,8991,8853,8786,8779,8706,7994,7955,7654,7622,7362,7350,7327,7153,7058,6501,6096,6037,5938,5763,5436,5433,5411,5389,5306,5269,5107,5010,4695,4417,4360,4356,4346,4242,4234,4190,4184,4107,3963,3831,3655,3603,3415,3344,3265,3212,3174,3107,3031,2975,2934,2840,2818,2816,2802,2782,2769,2519,2510,2205,2188,2174,2172,2151,2144,2135,2064,2002,1838,1800,1754,1567,1566,1359,1243,1209,1191,1124,937,806,772,622,592,571,547,497,448,447,380,340,326,266,261,221,202,192,171,122,112]],"container":"<table class=\"display\">\n  <thead>\n    <tr>\n      <th> <\/th>\n      <th>name<\/th>\n      <th>popularity<\/th>\n      <th>followers.total<\/th>\n    <\/tr>\n  <\/thead>\n<\/table>","options":{"columnDefs":[{"className":"dt-right","targets":[2,3]},{"orderable":false,"targets":0}],"order":[],"autoWidth":false,"orderClasses":false}},"evals":[],"jsHooks":[]}</script>
</div>
</div>
</section></section><section id="by-track" class="level2" data-number="J.4"><h2 data-number="J.4" class="anchored" data-anchor-id="by-track">
<span class="header-section-number">J.4</span> By Track</h2>
<p>You can get even more info about a specific track if you know its Spotify ID. You can get this from an artist, album, or playlist tables.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb28"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb28-1"><a href="#cb28-1"></a><span class="co"># get the ID for Born This Way from the original album</span></span>
<span id="cb28-2"><a href="#cb28-2"></a>btw_id <span class="ot">&lt;-</span> gaga <span class="sc">%&gt;%</span></span>
<span id="cb28-3"><a href="#cb28-3"></a>  <span class="fu">filter</span>(track_name <span class="sc">==</span> <span class="st">"Born This Way"</span>, </span>
<span id="cb28-4"><a href="#cb28-4"></a>         album_name <span class="sc">==</span> <span class="st">"Born This Way"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb28-5"><a href="#cb28-5"></a>  <span class="fu">pull</span>(track_id)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<section id="features" class="level3" data-number="J.4.1"><h3 data-number="J.4.1" class="anchored" data-anchor-id="features">
<span class="header-section-number">J.4.1</span> Features</h3>
<p>Features are a list of summary attributes of the track. These are also included in the previous tables, so this function isn’t very useful unless you are getting track IDs directly.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb29"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb29-1"><a href="#cb29-1"></a>btw_features <span class="ot">&lt;-</span> <span class="fu">get_track_audio_features</span>(btw_id)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-layout-align="center">
<div class="cell-output cell-output-stdout">
<pre><code>tibble [1 × 18] (S3: tbl_df/tbl/data.frame)
 $ danceability    : num 0.586
 $ energy          : num 0.827
 $ key             : int 11
 $ loudness        : num -5.1
 $ mode            : int 1
 $ speechiness     : num 0.15
 $ acousticness    : num 0.0037
 $ instrumentalness: int 0
 $ liveness        : num 0.328
 $ valence         : num 0.508
 $ tempo           : num 124
 $ type            : chr "audio_features"
 $ id              : chr "6aDi4gOE2Cfc6ecynvP81R"
 $ uri             : chr "spotify:track:6aDi4gOE2Cfc6ecynvP81R"
 $ track_href      : chr "https://api.spotify.com/v1/tracks/6aDi4gOE2Cfc6ecynvP81R"
 $ analysis_url    : chr "https://api.spotify.com/v1/audio-analysis/6aDi4gOE2Cfc6ecynvP81R"
 $ duration_ms     : int 260253
 $ time_signature  : int 4</code></pre>
</div>
</div>
</section><section id="analysis" class="level3" data-number="J.4.2"><h3 data-number="J.4.2" class="anchored" data-anchor-id="analysis">
<span class="header-section-number">J.4.2</span> Analysis</h3>
<p>The analysis gives you seven different tables of details about the track. Use the <code><a href="https://rdrr.io/r/base/names.html">names()</a></code> function to see their names and look at each object to see what information it contains.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb31"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb31-1"><a href="#cb31-1"></a>btw_analysis <span class="ot">&lt;-</span> <span class="fu">get_track_audio_analysis</span>(btw_id)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-layout-align="center">
<div class="cell-output cell-output-stdout">
<pre><code>[1] "meta"     "track"    "bars"     "beats"    "sections" "segments" "tatums"  </code></pre>
</div>
</div>
<ul>
<li>
<code>meta</code> gives you a list of some info about the analysis.</li>
<li>
<code>track</code> gives you a list of attributes, including <code>duration</code>, <code>loudness</code>, <code>end_of_fade_in</code>, <code>start_of_fade_out</code>, and <code>time_signature</code>. Some of this info was available in the previous tables.</li>
<li>
<code>bars</code>, <code>beats</code>, and <code>tatums</code> are tables with the start, duration and confidence for each bar, beat, or tatum of music (whatever a “tatum” is).</li>
<li>
<code>sections</code> is a table with the start, duration, loudness, tempo, key, mode, time signature for each section of music, along with confidence measures of each.</li>
<li>
<code>segments</code> is a table with information about loudness, pitch and timbre of segments of analysis, which tend to be around 0.2 (seconds?)</li>
</ul>
<p>You can use this data to map a song.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb33"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb33-1"><a href="#cb33-1"></a><span class="fu">ggplot</span>(btw_analysis<span class="sc">$</span>segments, <span class="fu">aes</span>(<span class="at">x =</span> start, </span>
<span id="cb33-2"><a href="#cb33-2"></a>                                  <span class="at">y =</span> loudness_start, </span>
<span id="cb33-3"><a href="#cb33-3"></a>                                  <span class="at">color =</span> loudness_start)) <span class="sc">+</span></span>
<span id="cb33-4"><a href="#cb33-4"></a>  <span class="fu">geom_point</span>(<span class="at">show.legend =</span> <span class="cn">FALSE</span>) <span class="sc">+</span></span>
<span id="cb33-5"><a href="#cb33-5"></a>  <span class="fu">scale_colour_gradient</span>(<span class="at">low =</span> <span class="st">"red"</span>, <span class="at">high =</span> <span class="st">"purple"</span>) <span class="sc">+</span></span>
<span id="cb33-6"><a href="#cb33-6"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">breaks =</span> <span class="fu">seq</span>(<span class="dv">0</span>, <span class="dv">300</span>, <span class="dv">30</span>)) <span class="sc">+</span></span>
<span id="cb33-7"><a href="#cb33-7"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Seconds"</span>,</span>
<span id="cb33-8"><a href="#cb33-8"></a>       <span class="at">y =</span> <span class="st">"Loudness"</span>,</span>
<span id="cb33-9"><a href="#cb33-9"></a>       <span class="at">title =</span> <span class="st">"Loudness Map for 'Born This Way'"</span>) <span class="sc">+</span></span>
<span id="cb33-10"><a href="#cb33-10"></a>  gaga_style</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure"><p><img src="app-spotify_files/figure-html/track-segment-map-1.png" class="img-fluid figure-img" style="width:100.0%"></p>
<p></p><figcaption class="figure-caption">Use data from the segments table of a track analysis to plot loudness over time.</figcaption><p></p>
</figure>
</div>
</div>
</div>


</section></section></main><!-- /main --><script src="https://ajax.googleapis.com/ajax/libs/jquery/3.6.1/jquery.min.js"></script><script>

/* update total correct if #webex-total_correct exists */
update_total_correct = function() {
  console.log("webex: update total_correct");

  if (t = document.getElementById("webex-total_correct")) {
    var correct = document.getElementsByClassName("webex-correct").length;
    var solvemes = document.getElementsByClassName("webex-solveme").length;
    var radiogroups = document.getElementsByClassName("webex-radiogroup").length;
    var selects = document.getElementsByClassName("webex-select").length;

    t.innerHTML = correct + " of " + (solvemes + radiogroups + selects) + " correct";
  }
}

/* webex-solution button toggling function */
b_func = function() {
  console.log("webex: toggle hide");

  var cl = this.parentElement.classList;
  if (cl.contains('open')) {
    cl.remove("open");
  } else {
    cl.add("open");
  }
}

/* function for checking solveme answers */
solveme_func = function(e) {
  console.log("webex: check solveme");

  var real_answers = JSON.parse(this.dataset.answer);
  var my_answer = this.value;
  var cl = this.classList;
  if (cl.contains("ignorecase")) {
    my_answer = my_answer.toLowerCase();
  }
  if (cl.contains("nospaces")) {
    my_answer = my_answer.replace(/ /g, "")
  }

  if (my_answer == "") {
    cl.remove("webex-correct");
    cl.remove("webex-incorrect");
  } else if (real_answers.includes(my_answer)) {
    cl.add("webex-correct");
    cl.remove("webex-incorrect");
  } else {
    cl.add("webex-incorrect");
    cl.remove("webex-correct");
  }

  // match numeric answers within a specified tolerance
  if(this.dataset.tol > 0){
    var tol = JSON.parse(this.dataset.tol);
    var matches = real_answers.map(x => Math.abs(x - my_answer) < tol)
    if (matches.reduce((a, b) => a + b, 0) > 0) {
      cl.add("webex-correct");
    } else {
      cl.remove("webex-correct");
    }
  }

  // added regex bit
  if (cl.contains("regex")){
    answer_regex = RegExp(real_answers.join("|"))
    if (answer_regex.test(my_answer)) {
      cl.add("webex-correct");
    }
  }

  update_total_correct();
}

/* function for checking select answers */
select_func = function(e) {
  console.log("webex: check select");

  var cl = this.classList

  /* add style */
  cl.remove("webex-incorrect");
  cl.remove("webex-correct");
  if (this.value == "answer") {
    cl.add("webex-correct");
  } else if (this.value != "blank") {
    cl.add("webex-incorrect");
  }

  update_total_correct();
}

/* function for checking radiogroups answers */
radiogroups_func = function(e) {
  console.log("webex: check radiogroups");

  var checked_button = document.querySelector('input[name=' + this.id + ']:checked');
  var cl = checked_button.parentElement.classList;
  var labels = checked_button.parentElement.parentElement.children;

  /* get rid of styles */
  for (i = 0; i < labels.length; i++) {
    labels[i].classList.remove("webex-incorrect");
    labels[i].classList.remove("webex-correct");
  }

  /* add style */
  if (checked_button.value == "answer") {
    cl.add("webex-correct");
  } else {
    cl.add("webex-incorrect");
  }

  update_total_correct();
}

window.onload = function() {
  console.log("webex onload");
  /* set up solution buttons */
  var buttons = document.getElementsByTagName("button");

  for (var i = 0; i < buttons.length; i++) {
    if (buttons[i].parentElement.classList.contains('webex-solution')) {
      buttons[i].onclick = b_func;
    }
  }

  /* set up webex-solveme inputs */
  var solveme = document.getElementsByClassName("webex-solveme");

  for (var i = 0; i < solveme.length; i++) {
    /* make sure input boxes don't auto-anything */
    solveme[i].setAttribute("autocomplete","off");
    solveme[i].setAttribute("autocorrect", "off");
    solveme[i].setAttribute("autocapitalize", "off");
    solveme[i].setAttribute("spellcheck", "false");
    solveme[i].value = "";

    /* adjust answer for ignorecase or nospaces */
    var cl = solveme[i].classList;
    var real_answer = solveme[i].dataset.answer;
    if (cl.contains("ignorecase")) {
      real_answer = real_answer.toLowerCase();
    }
    if (cl.contains("nospaces")) {
      real_answer = real_answer.replace(/ /g, "");
    }
    solveme[i].dataset.answer = real_answer;

    /* attach checking function */
    solveme[i].onkeyup = solveme_func;
    solveme[i].onchange = solveme_func;

    $(solveme[i]).after(" <span class='webex-icon'></span>");
  }

  /* set up radiogroups */
  var radiogroups = document.getElementsByClassName("webex-radiogroup");
  for (var i = 0; i < radiogroups.length; i++) {
    radiogroups[i].onchange = radiogroups_func;
  }

  /* set up selects */
  var selects = document.getElementsByClassName("webex-select");
  for (var i = 0; i < selects.length; i++) {
    selects[i].onchange = select_func;
    $(selects[i]).after(" <span class='webex-icon'></span>");
  }

  update_total_correct();
}

</script><script>
$( document ).ready(function() {
  var cite = ' ';
  var psyteachr = ' <a href="https://psyteachr.github.io/"><img src="images/logos/psyteachr_logo.png" style="height: 31px; color: white;" alt="psyTeachR: Reproducible Research" /></a>';
  var license = ' <a rel="license" href="https://creativecommons.org/licenses/by-sa/4.0/" target="blank"><img alt="Creative Commons License" style="border-width:0" src="https://i.creativecommons.org/l/by-sa/4.0/88x31.png"></a>';

  $("footer div.row div:eq(1) p").html(
    psyteachr + license + cite
  );

  function move_sidebar() {
    var w = window.innerWidth;
    if (w < 992) {
      $("#toc").appendTo($("#main-nav"));
    } else {
      $("#toc").appendTo($("div.sidebar-chapter"));
    }
  }
  move_sidebar();
  window.onresize = move_sidebar;
});
</script><script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const disableStylesheet = (stylesheets) => {
    for (let i=0; i < stylesheets.length; i++) {
      const stylesheet = stylesheets[i];
      stylesheet.rel = 'prefetch';
    }
  }
  const enableStylesheet = (stylesheets) => {
    for (let i=0; i < stylesheets.length; i++) {
      const stylesheet = stylesheets[i];
      stylesheet.rel = 'stylesheet';
    }
  }
  const manageTransitions = (selector, allowTransitions) => {
    const els = window.document.querySelectorAll(selector);
    for (let i=0; i < els.length; i++) {
      const el = els[i];
      if (allowTransitions) {
        el.classList.remove('notransition');
      } else {
        el.classList.add('notransition');
      }
    }
  }
  const toggleColorMode = (alternate) => {
    // Switch the stylesheets
    const alternateStylesheets = window.document.querySelectorAll('link.quarto-color-scheme.quarto-color-alternate');
    manageTransitions('#quarto-margin-sidebar .nav-link', false);
    if (alternate) {
      enableStylesheet(alternateStylesheets);
      for (const sheetNode of alternateStylesheets) {
        if (sheetNode.id === "quarto-bootstrap") {
          toggleBodyColorMode(sheetNode);
        }
      }
    } else {
      disableStylesheet(alternateStylesheets);
      toggleBodyColorPrimary();
    }
    manageTransitions('#quarto-margin-sidebar .nav-link', true);
    // Switch the toggles
    const toggles = window.document.querySelectorAll('.quarto-color-scheme-toggle');
    for (let i=0; i < toggles.length; i++) {
      const toggle = toggles[i];
      if (toggle) {
        if (alternate) {
          toggle.classList.add("alternate");     
        } else {
          toggle.classList.remove("alternate");
        }
      }
    }
    // Hack to workaround the fact that safari doesn't
    // properly recolor the scrollbar when toggling (#1455)
    if (navigator.userAgent.indexOf('Safari') > 0 && navigator.userAgent.indexOf('Chrome') == -1) {
      manageTransitions("body", false);
      window.scrollTo(0, 1);
      setTimeout(() => {
        window.scrollTo(0, 0);
        manageTransitions("body", true);
      }, 40);  
    }
  }
  const isFileUrl = () => { 
    return window.location.protocol === 'file:';
  }
  const hasAlternateSentinel = () => {  
    let styleSentinel = getColorSchemeSentinel();
    if (styleSentinel !== null) {
      return styleSentinel === "alternate";
    } else {
      return false;
    }
  }
  const setStyleSentinel = (alternate) => {
    const value = alternate ? "alternate" : "default";
    if (!isFileUrl()) {
      window.localStorage.setItem("quarto-color-scheme", value);
    } else {
      localAlternateSentinel = value;
    }
  }
  const getColorSchemeSentinel = () => {
    if (!isFileUrl()) {
      const storageValue = window.localStorage.getItem("quarto-color-scheme");
      return storageValue != null ? storageValue : localAlternateSentinel;
    } else {
      return localAlternateSentinel;
    }
  }
  let localAlternateSentinel = 'default';
  // Dark / light mode switch
  window.quartoToggleColorScheme = () => {
    // Read the current dark / light value 
    let toAlternate = !hasAlternateSentinel();
    toggleColorMode(toAlternate);
    setStyleSentinel(toAlternate);
  };
  // Ensure there is a toggle, if there isn't float one in the top right
  if (window.document.querySelector('.quarto-color-scheme-toggle') === null) {
    const a = window.document.createElement('a');
    a.classList.add('top-right');
    a.classList.add('quarto-color-scheme-toggle');
    a.href = "";
    a.onclick = function() { try { window.quartoToggleColorScheme(); } catch {} return false; };
    const i = window.document.createElement("i");
    i.classList.add('bi');
    a.appendChild(i);
    window.document.body.appendChild(a);
  }
  // Switch to dark mode if need be
  if (hasAlternateSentinel()) {
    toggleColorMode(true);
  } else {
    toggleColorMode(false);
  }
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    target: function(trigger) {
      return trigger.previousElementSibling;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script><nav class="page-navigation"><div class="nav-page nav-page-previous">
      <a href="./app-styling.html" class="pagination-link">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text"><span class="chapter-number">I</span>&nbsp; <span class="chapter-title">Styling Plots</span></span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="./app-webpage.html" class="pagination-link">
        <span class="nav-page-text"><span class="chapter-number">K</span>&nbsp; <span class="chapter-title">Webpages</span></span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav>
</div> <!-- /content -->
<footer class="footer"><div class="nav-footer">
    <div class="nav-footer-left">CC-BY 2022, psyTeachR</div>   
    <div class="nav-footer-right">
      <ul class="footer-items list-unstyled">
<li class="nav-item compact">
    <a class="nav-link" href="https://github.com/psyteachr/ads-v2">
      <i class="bi bi-github" role="img">
</i> 
    </a>
  </li>  
    <li class="nav-item compact">
    <a class="nav-link" href="https://twitter.com/psyteachr">
      <i class="bi bi-twitter" role="img">
</i> 
    </a>
  </li>  
    <li class="nav-item compact">
    <a class="nav-link" href="https://doi.org/10.5281/zenodo.6365077">
      <i class="bi bi-https://zenodo.org/badge/DOI/10.5281/zenodo.6365077.svg" role="img">
</i> 
    </a>
  </li>  
</ul>
</div>
  </div>
</footer>


</body></html>